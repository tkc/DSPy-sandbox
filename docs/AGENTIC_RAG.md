# Agentic RAG 解説（要約）

本ドキュメントは、Agentic RAG に関する公開記事の内容を**要約・整理**したものです。  
原文の転載ではなく、主要ポイントを独自に再構成しています。

## 1. 背景：従来の RAG の課題

従来の RAG（検索→生成のワンショット）では、以下のような問題が起きやすい。

- **検索が一発勝負**で、初回のリコールが低いと精度が落ちる
- **曖昧な質問**の意図を汲めず、適切な検索クエリを作れない
- **マルチステップ推論**や計算・外部API呼び出しが苦手

## 2. Agentic RAG の核心

Agentic RAG は LLM を単なる回答生成器ではなく、
**計画・探索・判断を行うエージェント**として動かすアプローチ。

- 必要なら **再検索** する
- 質問を **分解・言い換え** してクエリを改善する
- **ツールを選択** して外部情報や計算を実行する
- 結果を **検証し、足りなければ再探索** する

## 3. 代表的な解決パターン

### (1) 反復検索

- 初回の検索結果が弱いと判断したら、クエリを変えて再検索
- 検索のリコールと適合率の両方を改善

### (2) 曖昧性の解消

- 質問をサブクエリに分解
- 仮説文書を作って検索精度を上げる（例：HyDE 的手法）

### (3) マルチステップ推論

- 複数資料を横断して結論を統合
- 計算や外部APIなど、必要な処理を順に実行

### (4) 自己検証ループ

- 回答の妥当性を自己評価
- 不足があれば再検索して修正

## 4. 主要アーキテクチャパターン

- **単一エージェント＋ツール利用（ReAct）**
  - 1つのLLMが「思考→行動→観察」のループを回す

- **グラフ型ワークフロー**
  - 条件分岐・ループを組み込んだ RAG フローを定義

- **マルチエージェント協調**
  - 複数LLMが役割分担し、対話で問題を解決

- **自己改善ループ**
  - 回答後に評価・修正を繰り返す

## 5. 実務への示唆

- **精度向上**の一方で、**コスト・遅延**が増える
- 評価指標（メトリクス）とガードレール設計が重要
- データ品質がボトルネックになるため、**入力データ整備**が不可欠

## 6. サンプルコード（DSPy）

本リポジトリでは、Agentic RAG の最小構成を DSPy で再現したサンプルを用意しています。  
ReAct エージェントが検索ツールを呼び出し、必要な情報を集めて回答します。

- サンプル: `examples/07_agentic_rag.py`

実行例:

```bash
uv run python examples/07_agentic_rag.py
```

---

## 参考

- SoftBank 公式ブログ「Agentic RAGは従来のRAGの課題をどう解決するか？」（2025年12月1日掲載）
